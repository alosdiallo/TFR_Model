---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


```{r}
dfTmpLR <- NULL
dfTmpRF <- NULL
dfTmpNB <- NULL
dfTmpLDA <- NULL
dfTmpSVM <- NULL
dfTmp = NULL
svmTuneRes = NULL
Train = NULL
Test = NULL
dfTmpKNN = NULL


  bTrain = sample(1:nrow(model),round(0.7*nrow(model)))
  Train <- model[bTrain,]
  Test <- model[-bTrain,]
  Test = as.data.frame(Test)
  Train$cat = as.numeric(as.factor(Train$cat))
  Test$cat = as.numeric(as.factor(Test$cat))

# LDA:
ldaTrain <- lda(Train$cat~.,data=Train[,2:size],cv = TRUE)
ldaTestPred <- predict(ldaTrain, newdata=Train[,2:size])
tmpVals <- summPreds(as.numeric(ldaTestPred$class),as.factor(Train$cat))


dfTmp <- rbind(dfTmp,data.frame(resample=c("Bootstrap"),type="LDA",metric=names(tmpVals),value=tmpVals))
dfTmpLDA <- rbind(dfTmpLDA,data.frame(resample=c("Bootstrap"),type="LDA",metric=names(tmpVals),value=tmpVals))

# NB:
Y = factor(as.numeric(as.factor(Train$cat)))
nbTrain <- naiveBayes(Y~.,data=Train[,2:size])
nbTestPred = predict(nbTrain, newdata=Test[,2:size])
tmpVals = summPreds(as.numeric(nbTestPred),as.numeric(as.factor(Test$cat)))
dfTmp <- rbind(dfTmp,data.frame(resample=c("Bootstrap"),type="NB",metric=names(tmpVals),value=tmpVals))
dfTmpNB <- rbind(dfTmpNB,data.frame(resample=c("Bootstrap"),type="NB",metric=names(tmpVals),value=tmpVals))


```


```{r warning=FALSE}
dfTmpLR <- NULL
dfTmpLR_train <- NULL
dfTmpRF <- NULL
dfTmpNB <- NULL
dfTmpLDA <- NULL
dfTmpSVM <- NULL
dfTmp = NULL
svmTuneRes = NULL
Train = NULL
Test = NULL
dfTmpKNN = NULL




for ( iSim in 1:100 ) {
  bTrain = sample(1:nrow(model),round(0.7*nrow(model)))
  Train <- model[bTrain,]
  Test <- model[-bTrain,]
  Test = as.data.frame(Test)
  Train$cat = as.numeric(as.factor(Train$cat))
  Test$cat = as.numeric(as.factor(Test$cat))

  # logistic regression Test error:
  glmTrain <- glm(as.factor(Train$cat)~.,data=Train[,2:size],family=binomial)
  glmTestPred <- predict(glmTrain, newdata=Test[,2:size], type="response") > 0.5
  tmpVals <- summPreds(as.numeric(glmTestPred)+1,as.factor(Test$cat))
  dfTmp <- rbind(dfTmp,data.frame(resample=c("Test"),type="LR",metric=names(tmpVals),value=tmpVals))

  # logistic regression Training Error:
  glmTrain <- glm(as.factor(Train$cat)~.,data=Train[,2:size],family=binomial)
  tmpVals <- summPreds(glmTrain$fitted.values+1,as.factor(Train$cat))
  dfTmp <- rbind(dfTmp,data.frame(resample=c("Train"),type="LR",metric=names(tmpVals),value=tmpVals))
  
  # LDA Training Error:
  ldaTrain <- lda(Train$cat~.,data=Train[,2:size],cv = TRUE)
  ldaTestPred <- predict(ldaTrain, newdata=Train[,2:size])
  tmpVals <- summPreds(as.numeric(ldaTestPred$class),as.factor(Train$cat))
  dfTmp <- rbind(dfTmp,data.frame(resample=c("Train"),type="LDA",metric=names(tmpVals),value=tmpVals))
  
  # LDA Test Error:
  ldaTrain <- lda(Train$cat~.,data=Train[,2:size])
  ldaTestPred <- predict(ldaTrain, newdata=Test[,2:size])
  tmpVals <- summPreds(as.numeric(ldaTestPred$class),as.factor(Test$cat))
  dfTmp <- rbind(dfTmp,data.frame(resample=c("Test"),type="LDA",metric=names(tmpVals),value=tmpVals))
  
}

```





Here we have the performance metrics for each model.
```{r}
p = NULL
p = ggplot(dfTmp,aes(x=type,y=100*value,colour = type)) + geom_boxplot(fill="white") + geom_point() + facet_wrap(~resample+metric,ncol=4,scales="free") + xlab("") + ylab("") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme_bw()

p
```

```{r}

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
